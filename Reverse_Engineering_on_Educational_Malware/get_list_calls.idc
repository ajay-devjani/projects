//Details:
//Written by: Ajay Devjani, M.Tech INSE
//Project Co-partner: Rushaan Qureshi, M.Tech INSE
//Supervised by Prof: Makan Pourzandi

#include <idc.idc>
static main()
{
	auto ea, x, next_cref, cnt;
	auto fp, readDec, fname;
    fp = fopen("C:\\Reverse Engineering\\IDC Scripts\\py\\dec.txt", "r"); // fp is a file handle
    do {
		cnt = 0;
        readDec = readstr(fp);
		//Message("%s",get_name(readDec));
		ea = get_first_dref_to(readDec);
		while (ea != BADADDR)
		{
			cnt = cnt + 1;
			fname = get_func_name(ea);
			if(fname =="" || fname == " ")
				fname = get_name(ea);
			Message("%s,%s,%08lX,%d\n", get_name(readDec), fname, ea, cnt);
			ea = get_next_dref_to(readDec,ea);
		}
		//Message("%s","\n");
    } while (readDec != -1);

    for ( ea=NextFunction(0); ea != BADADDR; ea=NextFunction(ea) )
	{
		cnt = 0;
		next_cref = get_first_cref_to(ea);
		while (next_cref != BADADDR)
		{
			cnt = cnt + 1;
			Message("%s,%s,%08lX,%d\n", get_func_name(ea), get_func_name(next_cref),next_cref,cnt);
			next_cref = get_next_cref_to(ea,next_cref);
		}
		
	}
}
